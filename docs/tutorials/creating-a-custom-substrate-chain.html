<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Creating a Custom Substrate chain · Substrate Developer Hub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;[block:callout]&lt;/p&gt;
"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Creating a Custom Substrate chain · Substrate Developer Hub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="&lt;p&gt;[block:callout]&lt;/p&gt;
"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/img/Substrate-logo.svg"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub"/><h2 class="headerTitleWithLogo">Substrate Developer Hub</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/docs/quickstart/installing-substrate" target="_self">Docs</a></li><li class=""><a href="/tutorials" target="_self">Tutorials</a></li><li class=""><a href="https://www.parity.io/blog/" target="_self">Blog</a></li><li class=""><a href="/community/support" target="_self">Community</a></li><li class=""><a href="https://github.com/substrate-developer-hub/" target="_self">GitHub</a></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Tutorials</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Quick Start</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/quickstart/installing-substrate">Installing Substrate</a></li><li class="navListItem"><a class="navItem" href="/docs/quickstart/using-the-substrate-node-and-module-setup-scripts">Using the Substrate node and module setup scripts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Runtime</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Macros</h4><ul><li class="navListItem"><a class="navItem" href="/docs/runtime/macros/construct_runtime">Constructing a Runtime!</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime/macros/decl_module">Declaring a Module!</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime/macros/decl_storage">runtime/macros/decl_storage</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/runtime/types/call-enum">Call Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime/types/event-enum">Event Enum</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime/types/genesisconfig-struct">GenesisConfig Struct</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/runtime/architecture-of-a-runtime">Architecture of a Runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/runtime/substrate-runtime-module-library">Substrate Runtime Module Library</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Substrate Overview</h3><ul class=""><li class="navListItem"><a class="navItem" href="/docs/overview/extrinsics">Extrinsics</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/glossary">Glossary</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/low-level-data-format">Low-level Data Format</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/runtime-and-api">Runtime and API</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/substrate-bonds">overview/substrate-bonds</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/telemetry">Telemetry</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/transaction-lifecycle">Transaction Lifecycle</a></li><li class="navListItem"><a class="navItem" href="/docs/overview/versioning">Versioning</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Tutorials</h3><ul class=""><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Building a Token Curated Registry DAppChain using Substrate</h4><ul><li class="navListItem"><a class="navItem" href="/docs/tutorials/tcr/best-practices">Best Practices</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/tcr/building-a-ui-for-the-tcr-runtime">Building a UI for the TCR runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/tcr/building-an-event-based-off-chain-storage">Building an event based off-chain storage</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/tcr/building-the-substrate-tcr-runtime">Building the Substrate TCR runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/tcr/unit-testing-the-tcr-runtime-module">Unit testing the TCR runtime module</a></li></ul></div><li class="navListItem"><a class="navItem" href="/docs/tutorials/collator-nodes-on-polkadot-chains">tutorials/collator-nodes-on-polkadot-chains</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/docs/tutorials/creating-a-custom-substrate-chain">Creating a Custom Substrate chain</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/deploying-a-smart-contract-on-a-substrate-node-chain">Deploying a Smart Contract on a Substrate Node Chain</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/start-a-private-network-with-substrate">Start a Private Network with Substrate</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/keys--seeds--and-the--subkey--tool">Keys, Seeds, and the `subkey` Tool</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/governance--public--mechanism-with-a-substrate-node-chain">Governance &quot;Public&quot; Mechanism with a Substrate Node Chain</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/migrating-storage-to-a-new-substrate-node-s-runtime">Migrating Storage to a new Substrate Node&#x27;s Runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/substrate-collectables-workshop">tutorials/substrate-collectables-workshop</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/substrate-runtime-recipes">Substrate Runtime Recipes</a></li><li class="navListItem"><a class="navItem" href="/docs/tutorials/validator-nodes-and-nominators-on-substrate-chains">Validator Nodes and Nominators on Substrate chains</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 class="postHeaderTitle">Creating a Custom Substrate chain</h1></header><article><div><span><p>[block:callout]
{
&quot;type&quot;: &quot;warning&quot;,
&quot;title&quot;: &quot;Troubleshooting&quot;,
&quot;body&quot;: &quot;Substrate is a rapidly evolving project, which means that breaking changes may cause you problems when trying to follow the instructions below. Feel free to <a href="https://substrate.readme.io/v1.0.0/docs/feedback">contact us</a> with any problems you encounter.&quot;
}
[/block]
This document will walk you through the steps required to duplicate the demo that <a href="https://youtu.be/0IoUZdDi5Is">Gavin Wood presented at the 2018 Web3 Summit</a>, showing off how you can build a Runtime Library for a Substrate Blockchain in less than 30 min.</p>
<p>This tutorial will be written for a Mac OS X machine, and may require some finessing to get working on other operating systems.
[block:api-header]
{
&quot;title&quot;: &quot;Prerequisites&quot;
}
[/block]
To start, make sure your machine has the latest <a href="https://www.npmjs.com/get-npm">node and npm</a> installed. Then we need to make sure you are able to run Substrate, which means installing Rust and other dependencies.</p>
<p>This can be done with this simple one-liner (it may take a little while, so grab some tea and <a href="http://tiny.cc/substrate-getting-started">optionally walk through this presentation</a>):
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;curl <a href="https://getsubstrate.io">https://getsubstrate.io</a> -sSf | bash -s -- --fast&quot;,
&quot;language&quot;: &quot;shell&quot;
}
]
}
[/block]
You will also need to set up a few more repositories into your working folder which were used in the demo:</p>
<ul>
<li><a href="https://github.com/paritytech/substrate/tree/master/node-template">Substrate Node Template</a></li>
<li><a href="https://github.com/paritytech/substrate-ui">Substrate UI</a></li>
</ul>
<p>You can do that with some <a href="https://github.com/paritytech/substrate-up">script aliases</a> that were loaded on your machine:
[block:callout]
{
&quot;type&quot;: &quot;warning&quot;,
&quot;title&quot;: &quot;NOTE&quot;,
&quot;body&quot;: &quot;You may need to restart your terminal in order for these scripts and other Substrate commands to become available to you.&quot;
}
[/block]</p>
<p>[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;substrate-node-new substrate-node-template &lt;author-name&gt;\nsubstrate-ui-new substrate&quot;,
&quot;language&quot;: &quot;shell&quot;
}
]
}
[/block]
This will create a folder called <code>substrate-node-template</code> and <code>substrate-ui</code> with the corresponding repositories cloned in them. You can of course rename your projects in these commands, but for the sake of the clarity, we will continue with these folder names.</p>
<p>[block:api-header]
{
&quot;title&quot;: &quot;Step 1: Launch a Blockchain&quot;
}
[/block]
If you have set up everything correctly, you can now start a substrate dev chain! In the <code>substrate-node-template</code> folder, you can run the generated executable with:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;./target/release/substrate-node-template --dev&quot;,
&quot;language&quot;: &quot;shell&quot;
}
]
}
[/block]</p>
<p>[block:callout]
{
&quot;type&quot;: &quot;warning&quot;,
&quot;title&quot;: &quot;Purge the Chain Database&quot;,
&quot;body&quot;: &quot;If you run into any errors starting or running your node, you may need to purge the chain files on your computer. You can do this by running: <code>./target/release/substrate-node-template purge-chain --dev</code>.&quot;
}
[/block]
If everything is working it should start producing blocks!</p>
<p>To interact with the blockchain, you need to start the Substrate UI. Navigate to the <code>substrate-ui</code> folder and run:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;yarn run dev&quot;,
&quot;language&quot;: &quot;shell&quot;
}
]
}
[/block]
Finally, if open your browser to <a href="http://localhost:8000">http://localhost:8000</a>, you should be able to interact with your new chain!
[block:api-header]
{
&quot;title&quot;: &quot;Step 2: Add Alice to your network&quot;
}
[/block]
Alice is a hard-coded account in your blockchain's <a href="https://github.com/paritytech/substrate/blob/master/node-template/src/chain_spec.rs#L43">genesis block configuration</a>. To make your life easier, this account is automatically pre-funded with currency and made a &quot;super user&quot; to your blockchain's upgrade system.</p>
<p>To access the &quot;Alice&quot; account, go to the <code>Wallet</code> section of the Substrate UI, and add Alice using her name and seed URI: <code>//Alice</code>.</p>
<p><img src="https://i.imgur.com/ItPlikV.png" alt="An image of adding Alice to your wallet"></p>
<p>If all is working correctly, you can now go into the <code>Send Funds</code> section and send funds from <code>Alice</code> to <code>Default</code>. You will see that Alice has a bunch of <code>units</code> pre-funded in her account, so send 5000 and wait for the green checkmark and an updated balance for <code>Default</code> to show that the transfer has been successfully recorded on the blockchain.</p>
<p><img src="https://i.imgur.com/8IIg292.png" alt="An image of sending funds from alice to your default account">
[block:api-header]
{
&quot;title&quot;: &quot;Step 3: Create a new runtime module&quot;
}
[/block]
Now it's time to create our own runtime.</p>
<p>Open up the <code>substrate-node-template</code> folder and create a new file:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;./runtime/src/demo.rs&quot;,
&quot;language&quot;: &quot;text&quot;
}
]
}
[/block]</p>
<p>This is where our new runtime module will live. Inline comments will hopefully give you insight to what the code is doing.</p>
<p>First, we will need to import a few libraries at the top of our file:</p>
<p>[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;// Encoding library\nuse parity_codec::Encode;\n\n// Enables access to store a value in runtime storage\n// Imports the <code>Result</code> type that is returned from runtime functions\n// Imports the <code>decl_module!</code> and <code>decl_storage!</code> macros\nuse support::{StorageValue, dispatch::Result, decl_module, decl_storage};\n\n// Traits used for interacting with Substrate's Balances module\n// <code>Currency</code> gives you access to interact with the on-chain currency\n// <code>WithdrawReason</code> and <code>ExistenceRequirement</code> are enums for balance functions\nuse support::traits::{Currency, WithdrawReason, ExistenceRequirement};\n\n// These are traits which define behavior around math and hashing\nuse runtime_primitives::traits::{Zero, Hash, Saturating};\n\n// Enables us to verify an call to our module is signed by a user account\nuse system::ensure_signed;&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
All modules need to declare a trait named <code>Trait</code> which is used to define the unique types needed by the module. In this case, our module does not have any unique types of it own, but does inherit types from the balances module such as a <code>Balance</code>, which is the currency of our system.
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;pub trait Trait: balances::Trait {}&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
In this example, we will create a simple coin flip game. Users will pay an entry fee to play the game and then &quot;flip a coin&quot;. If they win they will get the contents of the pot. If they don't win, they will get nothing. No matter the outcome, their fee will be placed into the pot after the game resolves for the next user to try and win.</p>
<p>To start, we can define the storage items our module needs to track with the <a href="https://github.com/paritytech/wiki/blob/master/decl_storage.md"><code>decl_storage!</code> macro</a>:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;decl_storage! {\n  trait Store for Module&lt;T: Trait&gt; as Demo {\n    Payment get(payment): Option&lt;T::Balance&gt;;\n    Pot get(pot): T::Balance;\n    Nonce get(nonce): u64;\n  }\n}&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
A macro is code in Rust which can be used to generate other code. Here we have introduced a macro and custom syntax to make the declaration of storage simple and easy to read. This macro will take care of generating all of the proper code needed to actually interact with the Substrate storage database.</p>
<p>You can see in our storage, we have three items, two of which track a <code>Balance</code>, and one that tracks a nonce which is represented as a <code>u64</code>. <code>Payment</code> uses an <code>Option</code> to wrap the balance so that we can represent whether or not the <code>Payment</code> has been initialized with a value. Easy enough :)</p>
<p>Next we will need to define our dispatchable functions: the ones that a user can use to call into our blockchain system. This game will have two functions the user can interact with: one that lets us set the initial payment, and one that lets us play the game.
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;decl_module! {\n  pub struct Module&lt;T: Trait&gt; for enum Call where origin: T::Origin {\n    fn set_payment(<em>origin, value: T::Balance) -&gt; Result {\n      // Logic for setting the game payment\n    }\n    \n    fn play(origin) -&gt; Result {\n      // Logic for playing the game\n    }\n  }\n}&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
Now that we have established our module structure, we can add the logic which powers these functions. First, we will write the logic for initializing our storage items:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;// This function initializes the <code>payment</code> storage item\n// It also populates the pot with an initial value\nfn set_payment(origin, value: T::Balance) -&gt; Result {\n\t// Ensure that the function call is a signed message (i.e. a transaction)\n\tlet _ = ensure_signed(origin)?;\n\t// If <code>payment</code> is not initialized with some value\n\tif Self::payment().is_none() {\n\t\t// Set the value of <code>payment</code>\n\t\t&lt;Payment<T>&gt;::put(value);\n\t\t// Initialize the <code>pot</code> with the same value\n\t\t&lt;Pot<T>&gt;::put(value);\n\t}\n\t// Return Ok(()) when everything happens successfully\n\tOk(())\n}&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
Then we will write the <code>play()</code> function which will actually allow users to play our game.
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;// This function is allows a user to play our coin-flip game\nfn play(origin) -&gt; Result {\n\t// Ensure that the function call is a signed message (i.e. a transaction)\n\t// Additionally, derive the sender address from the signed message\n\tlet sender = ensure_signed(origin)?;\n\t// Ensure that <code>payment</code> storage item has been set\n\tlet payment = Self::payment().ok_or(&quot;Must have payment amount set&quot;)?;\n\t// Read our storage values, and place them in memory variables\n\tlet mut nonce = Self::nonce();\n\tlet mut pot = Self::pot();\n\n\t// Try to withdraw the payment from the account, making sure that it will not kill the account\n\tlet _ = &lt;balances::Module<T> as Currency&lt;</em>&gt;&gt;::withdraw(&amp;sender, payment, WithdrawReason::Reserve, ExistenceRequirement::KeepAlive)?;\n\n\t// Generate a random hash between 0-255 using a csRNG algorithm\n\tif (&lt;system::Module<T>&gt;::random_seed(), &amp;sender, nonce)\n\t\t.using_encoded(<T as system::Trait>::Hashing::hash)\n\t\t.using_encoded(|e| e[0] &lt; 128)\n\t{\n\t\t// If the user won the coin flip, deposit the pot winnings; cannot fail\n\t\tlet _ = &lt;balances::Module<T> as Currency&lt;_&gt;&gt;::deposit_into_existing(&amp;sender, pot)\n\t\t.expect(&quot;<code>sender</code> must exist since a transaction is being made and withdraw will keep alive; qed.&quot;);\n\t\t// Reduce the pot to zero\n\t\tpot = Zero::zero();\n\t}\n\n\t// No matter the outcome, increase the pot by the payment amount\n\tpot = pot.saturating_add(payment);\n\t// Increment the nonce\n\tnonce = nonce.wrapping_add(1);\n\n\t// Store the updated values for our module\n\t&lt;Pot<T>&gt;::put(pot);\n\t&lt;Nonce<T>&gt;::put(nonce);\n\n\t// Return Ok(()) when everything happens successfully\n\tOk(())\n}&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]</p>
<p>And that's it! This is how easy it can be to build new runtime modules using Substrate. You can find a complete version of this file <a href="https://github.com/shawntabrizi/substrate-package/blob/gav-demo/substrate-node-template/runtime/src/demo.rs">here</a> to check your work.
[block:api-header]
{
&quot;title&quot;: &quot;Step 4: Integrate our new module into our runtime&quot;
}
[/block]
To actually use our module, we need to tell our runtime that it exists. To do this we will be modifying the <code>./runtime/src/lib.rs</code> file:</p>
<p>First, we need to include the new file we created into our project:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;...\n/// Index of an account's extrinsic in the chain.\npub type Nonce = u64;\n\nmod demo;     // Add this line  &quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
Next, we need to tell our runtime about the <code>Trait</code> we exposed within the demo module.
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;...\n\nimpl sudo::Trait for Runtime {\n\t/// The uniquitous event type.\n\ttype Event = Event;\n\ttype Proposal = Call;\n}\n\nimpl demo::Trait for Runtime {}      // Add this line&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
Finally, we need to include our demo module in the runtime constructor, which is handled by the <code>construct_runtime!</code> macro:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;construct_runtime!(\n\tpub enum Runtime with Log(InternalLog: DigestItem&lt;Hash, Ed25519AuthorityId&gt;) where\n\t\tBlock = Block,\n\t\tNodeBlock = opaque::Block,\n\t\tUncheckedExtrinsic = UncheckedExtrinsic\n\t{\n\t\tSystem: system::{default, Log(ChangesTrieRoot)},\n\t\tTimestamp: timestamp::{Module, Call, Storage, Config<T>, Inherent},\n\t\tConsensus: consensus::{Module, Call, Storage, Config<T>, Log(AuthoritiesChange), Inherent},\n\t\tAura: aura::{Module},\n\t\tIndices: indices,\n\t\tBalances: balances,\n\t\tSudo: sudo,\n\t\tDemo: demo::{Module, Call, Storage},\t\t// Add this line\n\t}\n);&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
To make it more clear when our upgrade is successful, we can also update the name of our runtime's specification and implementation:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;/// This runtime version.\npub const VERSION: RuntimeVersion = RuntimeVersion {\n    spec_name: create_runtime_str!(&quot;demo&quot;),\t\t// Update this name\n    impl_name: create_runtime_str!(&quot;demo-node&quot;),\t// Update this name\n    authoring_version: 3,\n    spec_version: 3,\n    impl_version: 0,\n    apis: RUNTIME_API_VERSIONS,\n};&quot;,
&quot;language&quot;: &quot;rust&quot;
}
]
}
[/block]
Again, you can find a complete version of this file <a href="https://github.com/shawntabrizi/substrate-package/blob/gav-demo/substrate-node-template/runtime/src/lib.rs">here</a>.
[block:api-header]
{
&quot;title&quot;: &quot;Step 5: Upgrade our chain&quot;
}
[/block]
Now that we have created a new runtime module, it's time for us to upgrade our blockchain.</p>
<p>To do this, first we will need to compile our new runtime into a Wasm binary. Go into <code>substrate-node-template</code> and run:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;./scripts/build.sh&quot;,
&quot;language&quot;: &quot;shell&quot;
}
]
}
[/block]</p>
<p>If this completes successfully, it will update the following file:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;./runtime/wasm/target/wasm32-unknown-unknown/release/node_runtime.compact.wasm&quot;,
&quot;language&quot;: &quot;text&quot;
}
]
}
[/block]
You can go back to the Substrate UI, and in the <code>Runtime Upgrade</code> section, you can select this file and press <code>upgrade</code>.</p>
<p><img src="https://i.imgur.com/c0O2Pnf.png" alt="An image of a successful chain upgrade"></p>
<p>If all went well, you can see at the top of the Substrate UI that the <code>Runtime</code> will have our updated name!</p>
<p><img src="https://i.imgur.com/PLe219L.png" alt="An image of an updated runtime name"></p>
<p>[block:api-header]
{
&quot;title&quot;: &quot;Step 6: Interacting with our new module&quot;
}
[/block]
Finally, we can try and play the game we created. We will begin our interaction through the browser console.</p>
<p>On the page with the Substrate UI, press <em>F12</em> to open your developer console. We will take advantage of some of the JavaScript libraries loaded on this page.</p>
<p>Before we can play the game, we need to initialize the <code>set_payment</code> from an account. We will call the function on behalf of Alice, who will generously initialize the pot with a signed message.
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;post({sender: runtime.indices.ss58Decode('F7Hs'), call: calls.demo.setPayment(1000)}).tie(console.log)&quot;,
&quot;language&quot;: &quot;javascript&quot;
}
]
}
[/block]
<img src="https://i.imgur.com/nl0h2Ei.png" alt="An image of the setting the payment in the developer console"></p>
<p>When this call completed, you should see <code>{finalized: &quot;...&quot;}</code>, showing that it has been added to the chain. We can check this by reading the balance in the pot:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;runtime.demo.pot.then(console.log)&quot;,
&quot;language&quot;: &quot;javascript&quot;
}
]
}
[/block]
Which should return <code>Number {1000}</code>
[block:api-header]
{
&quot;title&quot;: &quot;Step 7: Updating our Substrate UI&quot;
}
[/block]
Now that we see things are working in the background, it's time to give our UI some new legs. Let's add an interface so that someone can play our game. To do this we will need to modify the <code>substrate-ui</code> repository.</p>
<p>Open the <code>./src/app.jsx</code> file, and in the <code>readyRender()</code> function, you will see the code which generates all the different UX components.</p>
<p>For example, this code snippet controls the Runtime Upgrade UX that we most recently interacted with:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;class UpgradeSegment extends React.Component {\n\tconstructor() {\n\t\tsuper()\n\t\tthis.conditionBond = runtime.metadata.map(m =&gt;\n\t\t\tm.modules &amp;&amp; m.modules.some(o =&gt; o.name === 'sudo')\n\t\t\t|| m.modules.some(o =&gt; o.name === 'upgrade_key')\n\t\t)\n\t\tthis.runtime = new Bond\n\t}\n\trender() {\n\t\treturn &lt;If condition={this.conditionBond} then={\n\t\t\t&lt;Segment style={{ margin: '1em' }} padded&gt;\n\t\t\t\t<Header as='h2'>\n\t\t\t\t\t<Icon name='search' />\n\t\t\t\t\t&lt;Header.Content&gt;\n\t\t\t\t\t\tRuntime Upgrade\n\t\t\t\t\t\t&lt;Header.Subheader&gt;Upgrade the runtime using the UpgradeKey module&lt;/Header.Subheader&gt;\n\t\t\t\t\t&lt;/Header.Content&gt;\n\t\t\t\t</Header>\n\t\t\t\t&lt;div style={{ paddingBottom: '1em' }}&gt;</div>\n\t\t\t\t<FileUploadBond bond={this.runtime} content='Select Runtime' />\n\t\t\t\t&lt;TransactButton\n\t\t\t\t\tcontent=&quot;Upgrade&quot;\n\t\t\t\t\ticon='warning'\n\t\t\t\t\ttx={{\n\t\t\t\t\t\tsender: runtime.sudo\n\t\t\t\t\t\t\t? runtime.sudo.key\n\t\t\t\t\t\t\t: runtime.upgrade_key.key,\n\t\t\t\t\t\tcall: calls.sudo\n\t\t\t\t\t\t\t? calls.sudo.sudo(calls.consensus.setCode(this.runtime))\n\t\t\t\t\t\t\t: calls.upgrade_key.upgrade(this.runtime)\n\t\t\t\t\t}}\n\t\t\t\t/&gt;\n\t\t\t</Segment>\n\t\t} /&gt;\n\t}\n}&quot;,
&quot;language&quot;: &quot;javascript&quot;,
&quot;name&quot;: &quot;React&quot;
}
]
}
[/block]
We can use this as a template for how we should add our game's UX. At the end of the file, add the following code:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;class DemoSegment extends React.Component {\n\tconstructor() {\n\t\tsuper()\n\n\t\tthis.player = new Bond\n\t}\n\n\trender() {\n\t\treturn &lt;Segment style={{ margin: '1em' }} padded&gt;\n\t\t\t<Header as='h2'>\n\t\t\t\t<Icon name='game' />\n\t\t\t\t&lt;Header.Content&gt;\n\t\t\t\t\tPlay the game\n\t\t\t&lt;Header.Subheader&gt;Play the game here!&lt;/Header.Subheader&gt;\n\t\t\t\t&lt;/Header.Content&gt;\n\t\t\t</Header>\n\t\t\t&lt;div style={{ paddingBottom: '1em' }}&gt;\n\t\t\t\t&lt;div style={{ fontSize: 'small' }}&gt;player</div>\n\t\t\t\t<SignerBond bond={this.player} />\n\t\t\t\t&lt;If condition={this.player.ready()} then={<span>\n\t\t\t\t\t<Label>Balance\n\t\t\t  &lt;Label.Detail&gt;\n\t\t\t\t\t\t\t<Pretty value={runtime.balances.balance(this.player)} />\n\t\t\t\t\t\t&lt;/Label.Detail&gt;\n\t\t\t\t\t</Label>\n\t\t\t\t</span>} /&gt;\n\t\t\t</div>\n\t\t\t&lt;TransactButton\n\t\t\t\tcontent=&quot;Play&quot;\n\t\t\t\ticon='game'\n\t\t\t\ttx={{\n\t\t\t\t\tsender: this.player,\n\t\t\t\t\tcall: calls.demo.play()\n\t\t\t\t}}\n\t\t\t/&gt;\n\t\t\t<Label>Pot Balance\n\t\t  &lt;Label.Detail&gt;\n\t\t\t\t\t<Pretty value={runtime.demo.pot} />\n\t\t\t\t&lt;/Label.Detail&gt;\n\t\t\t</Label>\n\t\t</Segment>\n\t}\n}&quot;,
&quot;language&quot;: &quot;javascript&quot;,
&quot;name&quot;: &quot;React&quot;
}
]
}
[/block]
Beyond the updated text, you can see we are accessing a new <code>this.player</code> bond, which represents the user context playing the game.</p>
<p>Using this, we can get details like the user's balance:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;runtime.balances.balance(this.player)&quot;,
&quot;language&quot;: &quot;javascript&quot;
}
]
}
[/block]
And submit transactions on behalf of this user:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;tx={{\n  sender: this.player,\n  call: calls.demo.play()\n}}&quot;,
&quot;language&quot;: &quot;javascript&quot;
}
]
}
[/block]
Also notice that we are able to dynamically show content like the current balance of the pot in a similar way to how we retrieved it in the developer console:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;<Label>Pot Balance\n  &lt;Label.Detail&gt;\n    <Pretty value={runtime.demo.pot}/>\n  &lt;/Label.Detail&gt;\n</Label>&quot;,
&quot;language&quot;: &quot;xml&quot;,
&quot;name&quot;: &quot;React&quot;
}
]
}
[/block]
The only thing left for us to do, is to add this component into our <code>App</code> class at the top of the file:
[block:code]
{
&quot;codes&quot;: [
{
&quot;code&quot;: &quot;readyRender() {\n\treturn (<div>\n\t\t<Heading />\n\t\t<WalletSegment />\n\t\t<Divider hidden />\n\t\t<AddressBookSegment />\n\t\t<Divider hidden />\n\t\t<FundingSegment />\n\t\t<Divider hidden />\n\t\t<UpgradeSegment />\n\t\t<Divider hidden />\n\t\t<PokeSegment />\n\t\t<Divider hidden />\n\t\t<TransactionsSegment />\n\t\t<Divider hidden />\n\t\t<DemoSegment />\t\t\t// Add this line\n\t</div>);\n}&quot;,
&quot;language&quot;: &quot;javascript&quot;
}
]
}
[/block]
If you save your changes and reload the page, you should see your new UX! You can now try playing the game with the <code>Default</code> user:</p>
<p><img src="https://i.imgur.com/sIspIKE.png" alt="An image of the player losing the game"></p>
<p>Here you can see the player lost the game, which means that their 1000 units got added to the pot, and an additional 1 unit transaction fee was taken from their balance.</p>
<p>If we try a few more times, eventually the player will win the game, and the pot will be reset back to its starting amount for the next player:</p>
<p><img src="https://i.imgur.com/kqQIF3p.png" alt="An image of the player winning the game">
[block:api-header]
{
&quot;title&quot;: &quot;Final Notes&quot;
}
[/block]
That's all folks! While you can't actually make a profit playing this game, hopefully you see just how simple Substrate can make it to develop your next blockchain.</p>
<p>In summary, we showed you how to:</p>
<ul>
<li>Download and install <code>substrate</code> to your machine in a single command</li>
<li>Set up a fresh <code>substrate-node-template</code> and <code>substrate-ui</code> so that you can start hacking right away</li>
<li>Program a new runtime for your blockchain</li>
<li>Upgrade your runtime, in real-time and without forking, via the <code>substrate-ui</code></li>
<li>Update the <code>substrate-ui</code> to reflect your new runtime features and functionality</li>
</ul>
<p>Substrate is a rapidly developing technology, and we would love to get your feedback, answer questions, and learn more about what you want to build! Feel free to contact us using the details provided <a href="https://substrate.readme.io/v1.0.0/docs/feedback">here</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/tutorials/collator-nodes-on-polkadot-chains"><span class="arrow-prev">← </span><span>tutorials/collator-nodes-on-polkadot-chains</span></a><a class="docs-next button" href="/docs/tutorials/deploying-a-smart-contract-on-a-substrate-node-chain"><span>Deploying a Smart Contract on a Substrate Node Chain</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub" width="66" height="58"/></a><div><h5>Docs</h5><a href="/en/who">Getting Started</a><a href="/en/tutorials">Tutorials</a><a href="https://crates.parity.io">Reference Docs</a></div><div><h5>Community</h5><a href="/en/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.im/app/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Riot Chat</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/blog">Blog</a><a href="https://github.com/paritytech/substrate">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Parity Technologies</section></footer></div></body></html>