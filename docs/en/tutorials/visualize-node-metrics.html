<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Visualizing Node Metrics · Substrate Developer Hub</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="Recent versions of Substrate expose metrics, such as how many peers your node is"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Visualizing Node Metrics · Substrate Developer Hub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="Recent versions of Substrate expose metrics, such as how many peers your node is"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script><script type="text/javascript" src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script><script type="text/javascript" src="/js/clipboard.min.js"></script><script type="text/javascript" src="/js/code-block-buttons.js"></script><script type="text/javascript" src="/js/load.js"></script><script type="text/javascript" src="/js/past-seminars.js"></script><script type="text/javascript" src="/js/config.js" defer=""></script><script type="text/javascript" src="/js/klaro.min.js" defer=""></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/en"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub"/><h2 class="headerTitleWithLogo">Substrate Developer Hub</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="/en/tutorials" target="_self">Tutorials</a></li><li class=""><a href="/docs/en/" target="_self">Knowledge Base</a></li><li class=""><a href="https://substrate.dev/recipes/" target="_self">Recipes</a></li><li class=""><a href="https://substrate.dev/substrate-how-to-guides/" target="_self">How-to Guides</a></li><li class=""><a href="https://substrate.dev/rustdocs/" target="_self">Reference</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>English</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/zh-CN/tutorials/visualize-node-metrics">简体中文</a></li><li><a href="https://crowdin.com/project/substrate-developer-hub" target="_blank" rel="noreferrer noopener">Help Translate</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://github.com/substrate-developer-hub/substrate-developer-hub.github.io/edit/source/docs/tutorials/visualize-node-metrics.md" target="_blank" rel="noreferrer noopener">Edit</a><h1 id="__docusaurus" class="postHeaderTitle">Visualizing Node Metrics</h1></header><article><div><span><p>Recent versions of Substrate expose metrics, such as how many peers your node is
connected to, how much memory your node is using, etc. To visualize these
metrics, you can use tools like <a href="https://prometheus.io/">Prometheus</a> and
<a href="https://grafana.com/">Grafana</a>.</p>
<blockquote>
<p>Note: In the past Substrate exposed a Grafana JSON endpoint directly. This has
been replaced with a Prometheus metric endpoint.</p>
</blockquote>
<p>A possible architecture could look like:</p>
<pre><code class="hljs"><span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>                     <span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>                                                              <span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
<span class="token operator">|</span> <span class="token class-name">Substrate</span> <span class="token operator">|</span>                     <span class="token operator">|</span> <span class="token class-name">Prometheus</span>  <span class="token operator">|</span>                                                              <span class="token operator">|</span> <span class="token class-name">Grafana</span> <span class="token operator">|</span>
<span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>                     <span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>                                                              <span class="token operator">+</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">+</span>
      <span class="token operator">|</span>               <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>\ <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>               <span class="token operator">|</span> <span class="token class-name">Every</span> <span class="token number">1</span> minute <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>               <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span> <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>        <span class="token constant">GET</span> current metric values <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span> `substrate_peers_count <span class="token number">5</span>`        <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">-></span><span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span> <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>\    <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">|</span> <span class="token class-name">Save</span> metric value with corresponding time stamp <span class="token keyword">in</span> local database <span class="token operator">|</span>    <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span> <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span>    <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                         <span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>\ <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                         <span class="token operator">|</span> <span class="token class-name">Every</span> time user opens graphs <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                         <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span> <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>       <span class="token constant">GET</span> values of metric `substrate_peers_count` from time<span class="token operator">-</span><span class="token class-name">X</span> to time<span class="token operator">-</span><span class="token class-name">Y</span> <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span><span class="token operator">&lt;</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                                                          <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span> `<span class="token function">substrate_peers_count</span> <span class="token punctuation">(</span><span class="token number">1582023828</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1582023847</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">...</span><span class="token punctuation">]</span>`           <span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token punctuation">-></span><span class="token operator">|</span>
      <span class="token operator">|</span>                                  <span class="token operator">|</span>                                                                          <span class="token operator">|</span>

</code></pre>
<p><details>
<summary>Reproduce diagram</summary></p>
<p>Go to: <a href="https://textart.io/sequence">https://textart.io/sequence</a></p>
<pre><code class="hljs">object <span class="token class-name">Substrate</span> <span class="token class-name">Prometheus</span> <span class="token class-name">Grafana</span>
note left of <span class="token class-name">Prometheus</span><span class="token punctuation">:</span> <span class="token class-name">Every</span> <span class="token number">1</span> minute
<span class="token class-name">Prometheus</span><span class="token punctuation">-></span><span class="token class-name">Substrate</span><span class="token punctuation">:</span> <span class="token constant">GET</span> current metric values
<span class="token class-name">Substrate</span><span class="token punctuation">-></span><span class="token class-name">Prometheus</span><span class="token punctuation">:</span> `substrate_peers_count <span class="token number">5</span>`
note right of <span class="token class-name">Prometheus</span><span class="token punctuation">:</span> <span class="token class-name">Save</span> metric value with corresponding time stamp <span class="token keyword">in</span> local database
note left of <span class="token class-name">Grafana</span><span class="token punctuation">:</span> <span class="token class-name">Every</span> time user opens graphs
<span class="token class-name">Grafana</span><span class="token punctuation">-></span><span class="token class-name">Prometheus</span><span class="token punctuation">:</span> <span class="token constant">GET</span> values of metric `substrate_peers_count` from time<span class="token operator">-</span><span class="token class-name">X</span> to time<span class="token operator">-</span><span class="token class-name">Y</span>
<span class="token class-name">Prometheus</span><span class="token punctuation">-></span><span class="token class-name">Grafana</span><span class="token punctuation">:</span> `<span class="token function">substrate_peers_count</span> <span class="token punctuation">(</span><span class="token number">1582023828</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">1582023847</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token punctuation">[</span><span class="token punctuation">...</span><span class="token punctuation">]</span>`
</code></pre>
<p></details></p>
<h2><a class="anchor" aria-hidden="true" id="install-prometheus-and-grafana"></a><a href="#install-prometheus-and-grafana" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install Prometheus and Grafana</h2>
<ol>
<li>Install Prometheus <a href="https://prometheus.io/docs/prometheus/latest/installation/">here</a></li>
<li>Install Grafana <a href="https://grafana.com/get">here</a></li>
</ol>
<blockquote>
<p>Note: we suggest for <em>testing</em> that you download the compiled <code>bin</code> programs for these apps
as apposed to fully installing them or using them in docker. Just <code>download</code> for your
architecture, and run it from the <code>working directory</code> that is convenient for you.
The links above provide instruction on this, and this guide assume you do it this way.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="start-a-substrate-template-node"></a><a href="#start-a-substrate-template-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Start a Substrate Template Node</h2>
<blockquote>
<p>Before you continue here, you should complete the
<a href="/docs/en/tutorials/create-your-first-substrate-chain/">create your first substrate chain</a>
tutorial. The same substrate version, conventions for
directory structure, and bin names are used here.
You can of course use your own custom substrate node instead of the template,
just edit the commands shown as needed.</p>
</blockquote>
<p>Substrate exposes an endpoint which serves metrics in the <a href="https://prometheus.io/docs/concepts/data_model/">Prometheus exposition
format</a> available on port
<code>9615</code>. You can change the port with <code>--prometheus-port &lt;PORT&gt;</code> and enable it to
be accessed over an interface other than local host with
<code>--prometheus-external</code>.</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># clear the dev database</span>
./target/release/node-template purge-chain --dev -y
<span class="hljs-comment"># start the template node  in dev &amp; tmp mode to experiment</span>
<span class="hljs-comment"># optionally add the `--prometheus-port &lt;PORT&gt;`</span>
<span class="hljs-comment"># or `--prometheus-external` flags</span>
./target/release/node-template --dev --tmp
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="configure-prometheus-to-scrape-your-substrate-node"></a><a href="#configure-prometheus-to-scrape-your-substrate-node" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configure Prometheus to scrape your Substrate node</h2>
<p>In the working directory where you installed Prometheus, you will find a <code>prometheus.yml</code> configuration file.
Let's modify this (or create a custom new on) to configure Prometheus to scrape the exposed endpoint by adding
it to the targets array. If you modify the default, here is what will be different:</p>
<pre><code class="hljs css language-yml"><span class="hljs-comment"># --snip--</span>

<span class="hljs-comment"># A scrape configuration containing exactly one endpoint to scrape:</span>
<span class="hljs-comment"># Here it's Prometheus itself.</span>
<span class="hljs-attr">scrape_configs:</span>
  <span class="hljs-comment"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span>
  <span class="hljs-bullet">-</span> <span class="hljs-attr">job_name:</span> <span class="hljs-string">"substrate_node"</span>

    <span class="hljs-comment"># metrics_path defaults to '/metrics'</span>
    <span class="hljs-comment"># scheme defaults to 'http'.</span>

    <span class="hljs-comment"># Override the global default and scrape targets from this job every 5 seconds.</span>
    <span class="hljs-comment"># ** <span class="hljs-doctag">NOTE:</span> you want to have this *LESS THAN* the block time in order to ensure</span>
    <span class="hljs-comment"># ** that you have a data point for every block!</span>
    <span class="hljs-attr">scrape_interval:</span> <span class="hljs-string">5s</span>

    <span class="hljs-attr">static_configs:</span>
      <span class="hljs-bullet">-</span> <span class="hljs-attr">targets:</span> <span class="hljs-string">["localhost:9615"]</span>
</code></pre>
<blockquote>
<p><strong>NOTE:</strong> you want to have <code>scrape_interval</code> <em>less than</em> the block time
in order to ensure that you have a data point for every block!</p>
</blockquote>
<p>Now we can start a Prometheus instance with the prometheus.yml config file. Presuming you downloaded the binary,
<code>cd</code> into the install directory and run:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># specify a custom config file instead if you made one here:</span>
./prometheus --config.file prometheus.yml
</code></pre>
<p>leave this process running.</p>
<h2><a class="anchor" aria-hidden="true" id="check-all-prometheus-metrics"></a><a href="#check-all-prometheus-metrics" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Check All Prometheus Metrics</h2>
<p>In a new terminal, we can do a quick status check on prometheus:</p>
<pre><code class="hljs css language-bash">curl localhost:9615/metrics
</code></pre>
<p>Which should return a similar output to:</p>
<pre><code class="hljs css language-bash"><span class="hljs-comment"># HELP substrate_block_height Block height info of the chain</span>
<span class="hljs-comment"># TYPE substrate_block_height gauge</span>
substrate_block_height{status=<span class="hljs-string">"best"</span>} 7
substrate_block_height{status=<span class="hljs-string">"finalized"</span>} 4
<span class="hljs-comment"># HELP substrate_build_info A metric with a constant '1' value labeled by name, version</span>
<span class="hljs-comment"># TYPE substrate_build_info gauge</span>
substrate_build_info{name=<span class="hljs-string">"available-vacation-6791"</span>,version=<span class="hljs-string">"2.0.0-4d97032-x86_64-linux-gnu"</span>} 1
<span class="hljs-comment"># HELP substrate_database_cache_bytes RocksDB cache size in bytes</span>
<span class="hljs-comment"># TYPE substrate_database_cache_bytes gauge</span>
substrate_database_cache_bytes 0
<span class="hljs-comment"># HELP substrate_finality_grandpa_precommits_total Total number of GRANDPA precommits cast locally.</span>
<span class="hljs-comment"># TYPE substrate_finality_grandpa_precommits_total counter</span>
substrate_finality_grandpa_precommits_total 31
<span class="hljs-comment"># HELP substrate_finality_grandpa_prevotes_total Total number of GRANDPA prevotes cast locally.</span>
<span class="hljs-comment"># TYPE substrate_finality_grandpa_prevotes_total counter</span>
substrate_finality_grandpa_prevotes_total 31
<span class="hljs-comment">#</span>
<span class="hljs-comment"># --snip--</span>
<span class="hljs-comment">#</span>
</code></pre>
<p>Alternatively in a browser open that same URL (<a href="http://localhost:9615/metrics">http://localhost:9615/metrics</a>) to view
all available metric data.</p>
<blockquote>
<p>NOTE: here you can see the <code>HELP</code> fields for each metric that is exposed for monitoring via grafana.</p>
</blockquote>
<h2><a class="anchor" aria-hidden="true" id="visualizing-prometheus-metrics-with-grafana"></a><a href="#visualizing-prometheus-metrics-with-grafana" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Visualizing Prometheus Metrics with Grafana</h2>
<p>Once you have Grafana running, navigate to it in a browser (<strong>the default is <a href="http://localhost:3000/">http://localhost:3000/</a></strong>).
Log in (default user <code>admin</code> and password <code>admin</code>) and navigate to the <a href="http://localhost:3000/datasources">data sources</a> page.</p>
<p>You then need to select a <code>Prometheus</code> data source type and specify where Grafana needs to look for it.</p>
<blockquote>
<p>Note: The Prometheus port Grafana needs is NOT the one you set in the <code>prometheus.yml</code> file (<a href="http://localhost:9615">http://localhost:9615</a>) for where your node is publishing it's data.</p>
</blockquote>
<p>With your substrate node and Prometheus are running, configure Grafana to look for Prometheus
on it's default port: <a href="http://localhost:9090">http://localhost:9090</a> (unless you customized it).</p>
<p>Hit <code>Save &amp; Test</code> to ensure that you have the data source set correctly. Now you can configure a new dashboard!</p>
<h3><a class="anchor" aria-hidden="true" id="template-grafana-dashboard"></a><a href="#template-grafana-dashboard" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Template Grafana Dashboard</h3>
<p>If you would like a basic dashboard to start <a href="/docs/assets/tutorials/visualize-node-metrics/Substrate-Node-Template-Metrics.json">here is a template example</a> that you can <code>Import</code> in Grafana to get basic information about your node:</p>
<p><br>
<center><img src="/docs/assets/tutorials/visualize-node-metrics/grafana.png" alt="grafana dashboard" width="50%"/></center>
<br></p>
<p>If you create your own, the <a href="https://prometheus.io/docs/visualization/grafana/">prometheus docs for grafana</a>
may be helpful.</p>
<p><b>If you do create one, consider uploading it to the
<a href="https://grafana.com/grafana/dashboards">community list of dashboards</a> and letting
the substrate builder community know it exists by listing in on
<a href="https://github.com/substrate-developer-hub/awesome-substrate">Awesome Substrate</a>!
Here is ours on <a href="https://grafana.com/grafana/dashboards/13759/">the grafana public dashboards</a></b></p>
<h2><a class="anchor" aria-hidden="true" id="next-steps"></a><a href="#next-steps" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Next Steps</h2>
<h3><a class="anchor" aria-hidden="true" id="learn-more"></a><a href="#learn-more" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Learn More</h3>
<ul>
<li>Learn how to <a href="../../tutorials/start-a-private-network/">set up a private Substrate network</a>.</li>
<li>Further configuration, notification services, and permanent installation of
<a href="https://wiki.polkadot.network/docs/maintain-guides-how-to-monitor-your-node">Substrate/Polkadot monitoring tools</a></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="examples"></a><a href="#examples" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Examples</h3>
<ul>
<li>The Grafana dashboard configuration for the <a href="https://github.com/w3f/polkadot-dashboard">Polkadot
network</a>.</li>
<li><a href="https://grafana.com/grafana/dashboards/13759/">Grafana Template</a> for a Substrate Node Template</li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="references"></a><a href="#references" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>References</h3>
<!-- TODO: Update this to RUSTDOC link-->
<ul>
<li>Visit the source code for
<a href="https://github.com/paritytech/substrate/tree/master/utils/prometheus">Substrate Prometheus Exporter</a>.</li>
<li>See the <a href="https://substrate.dev/rustdocs/latest/prometheus/index.html">docs for prometheus in substrate</a>.</li>
</ul>
</span></div></article></div><div class="docLastUpdate"><em>Last updated on 10/6/2021 by agryaznov</em></div><div class="docs-prevnext"></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#install-prometheus-and-grafana">Install Prometheus and Grafana</a></li><li><a href="#start-a-substrate-template-node">Start a Substrate Template Node</a></li><li><a href="#configure-prometheus-to-scrape-your-substrate-node">Configure Prometheus to scrape your Substrate node</a></li><li><a href="#check-all-prometheus-metrics">Check All Prometheus Metrics</a></li><li><a href="#visualizing-prometheus-metrics-with-grafana">Visualizing Prometheus Metrics with Grafana</a><ul class="toc-headings"><li><a href="#template-grafana-dashboard">Template Grafana Dashboard</a></li></ul></li><li><a href="#next-steps">Next Steps</a><ul class="toc-headings"><li><a href="#learn-more">Learn More</a></li><li><a href="#examples">Examples</a></li><li><a href="#references">References</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub" width="66" height="58"/></a><div><h5>Developer Hub</h5><a href="/en/tutorials">Tutorials</a><a href="/docs/en/">Knowledge Base</a><a href="https://substrate.dev/recipes/">Recipes</a><a href="https://substrate.dev/substrate-how-to-guides">How-to Guides</a><a href="https://substrate.dev/rustdocs">API Reference</a><a href="https://playground.substrate.dev/">Playground</a></div><div><h5>Community</h5><a href="/en/community">Community Home</a><a href="/en/newsletter">Newsletter</a><a href="https://matrix.to/#/#substrate-technical:matrix.org">Substrate Technical Chat</a><a href="/en/seminar">Substrate Seminar</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://twitter.com/substrate_io" target="_blank" rel="noreferrer noopener">Twitter</a><a href="https://www.meetup.com/parity/" target="_blank" rel="noreferrer noopener">Events</a></div><div><h5>More</h5><a href="https://www.substrate.io/builders-program/">Substrate Builders Program</a><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/paritytech/substrate">Substrate GitHub</a><a href="https://github.com/substrate-developer-hub/">Developer Hub GitHub</a><a href="https://www.parity.io/privacy/">Privacy Policy</a><a href="/terms">Terms of Use</a><a href="#" id="cookie-settings">Cookie Settings<script>
                var cookieSettings = document.getElementById('cookie-settings');
                cookieSettings.onclick = function() {
                  return klaro.show();
                };
              </script></a></div></section><section class="copyright">Copyright © 2022 Parity Technologies</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5cd09916f4ba4c283b2d45ee7386fc34',
                indexName: 'substrate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:en"]}
              });
            </script></body></html>