<!DOCTYPE html><html lang="zh-CN"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>构建一个Runtime · Substrate Developer Hub</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="&lt;p&gt;The &lt;code&gt;construct_runtime!&lt;/code&gt; macro is where you declare all the runtime modules you would like to include into your blockchain&#x27;s runtime. This includes any modules from the Substrate Runtime Module Library (SRML) or even custom modules you may have written.&lt;/p&gt;
"/><meta name="docsearch:language" content="zh-CN"/><meta property="og:title" content="构建一个Runtime · Substrate Developer Hub"/><meta property="og:type" content="website"/><meta property="og:url" content="https://substrate-developer-hub.github.io//"/><meta property="og:description" content="&lt;p&gt;The &lt;code&gt;construct_runtime!&lt;/code&gt; macro is where you declare all the runtime modules you would like to include into your blockchain&#x27;s runtime. This includes any modules from the Substrate Runtime Module Library (SRML) or even custom modules you may have written.&lt;/p&gt;
"/><meta property="og:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://substrate-developer-hub.github.io/img/substrate-dev-hub-card.png"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100}
          )
        });
        </script><script src="/js/scrollSpy.js"></script><link rel="stylesheet" href="/css/prism.css"/><link rel="stylesheet" href="/css/main.css"/><script src="/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/zh-CN"><img class="logo" src="/img/Substrate-logo.svg" alt="Substrate Developer Hub"/><h2 class="headerTitleWithLogo">Substrate Developer Hub</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/zh-CN/getting-started/" target="_self">文档</a></li><li class=""><a href="/rustdocs/v1.0/" target="_self">参考文档</a></li><li class=""><a href="/zh-CN/tutorials" target="_self">指南</a></li><li class=""><a href="/zh-CN/community" target="_self">社区</a></li><li class=""><a href="https://github.com/paritytech/substrate" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li><span><li><a id="languages-menu" href="#"><img class="languages-icon" src="/img/language.svg" alt="Languages icon"/>中文</a><div id="languages-dropdown" class="hide"><ul id="languages-dropdown-items"><li><a href="/docs/en/runtime/macros/construct_runtime">English</a></li><li><a href="https://crowdin.com/project/substrate-developer-hub" target="_blank" rel="noreferrer noopener">参与翻译</a></li></ul></div></li><script>
        const languagesMenuItem = document.getElementById("languages-menu");
        const languagesDropDown = document.getElementById("languages-dropdown");
        languagesMenuItem.addEventListener("click", function(event) {
          event.preventDefault();

          if (languagesDropDown.className == "hide") {
            languagesDropDown.className = "visible";
          } else {
            languagesDropDown.className = "hide";
          }
        });
      </script></span></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Runtime Macros</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">开始吧<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/getting-started/">开始吧</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/getting-started/installing-substrate">安装 Substrate</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/getting-started/using-the-substrate-scripts">Using the Substrate node and module setup scripts</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Substrate 基础<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/">介绍</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/extrinsics">外部参数</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/transaction-lifecycle">交易生命周期</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/low-level-data-format">底层数据格式</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/off-chain-workers">Substrate Off-Chain Workers</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/session-keys">会话秘钥</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/ss58-address-format">SS58 地址格式</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/overview/glossary">术语</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Runtime<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/architecture-of-a-runtime">Runtime的架构</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/substrate-runtime-module-library">Substrate Runtime 模块库</a></li><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Macros</h4><ul><li class="navListItem navListItemActive"><a class="navItem" href="/docs/zh-CN/runtime/macros/construct_runtime">构建一个Runtime</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/macros/decl_module">定义模块</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Runtime Types</h4><ul><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/types/call-enum">Call 枚举类型</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/types/event-enum">Event 枚举类型</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/runtime/types/genesisconfig-struct">GenesisConfig 结构体</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Substrate Contracts<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/">Introduction to Smart Contracts on Substrate</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/installing-ink">Installing ink!</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/cargo-contract">Cargo Contract: The ink! CLI</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/testing-your-contract">Testing Your Contract</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/deploying-a-contract">Deploying a Contract</a></li><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contracts/faq">Frequently Asked Questions</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">常用工具<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/ecosystem/subkey">`subkey` 工具</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">贡献<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/docs/zh-CN/contribute/help-translate">参与翻译</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><a class="edit-page-link button" href="https://crowdin.com/project/substrate-developer-hub/zh-CN" target="_blank" rel="noreferrer noopener">Translate</a><h1 class="postHeaderTitle">构建一个Runtime</h1></header><article><div><span><p>The <code>construct_runtime!</code> macro is where you declare all the runtime modules you would like to include into your blockchain's runtime. This includes any modules from the Substrate Runtime Module Library (SRML) or even custom modules you may have written.</p>
<p>You can find an example of a <code>construct_runtime!</code> definition from the Substrate <a href="https://github.com/paritytech/substrate/blob/master/node-template/runtime/src/lib.rs">node-template</a>:</p>
<pre><code class="hljs css language-rust"><span class="token function">construct_runtime!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> Runtime with <span class="token function">Log</span><span class="token punctuation">(</span>InternalLog<span class="token punctuation">:</span> DigestItem<span class="token operator">&lt;</span>Hash<span class="token punctuation">,</span> Ed25519AuthorityId<span class="token operator">></span><span class="token punctuation">)</span> <span class="token keyword">where</span>
        Block <span class="token operator">=</span> Block<span class="token punctuation">,</span>
        NodeBlock <span class="token operator">=</span> opaque<span class="token punctuation">:</span><span class="token punctuation">:</span>Block<span class="token punctuation">,</span>
        UncheckedExtrinsic <span class="token operator">=</span> UncheckedExtrinsic
    <span class="token punctuation">{</span>
        System<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>default<span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
        Timestamp<span class="token punctuation">:</span> timestamp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> Inherent<span class="token punctuation">}</span><span class="token punctuation">,</span>
        Consensus<span class="token punctuation">:</span> consensus<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>AuthoritiesChange<span class="token punctuation">)</span><span class="token punctuation">,</span> Inherent<span class="token punctuation">}</span><span class="token punctuation">,</span>
        Aura<span class="token punctuation">:</span> aura<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">}</span><span class="token punctuation">,</span>
        Indices<span class="token punctuation">:</span> indices<span class="token punctuation">,</span>
        Balances<span class="token punctuation">:</span> balances<span class="token punctuation">,</span>
        Sudo<span class="token punctuation">:</span> sudo<span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="defining-the-modules-used"></a><a href="#defining-the-modules-used" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Defining the Modules Used</h2>
<p>In the example above, we only use modules in the SRML, but you can see that there are different syntactical ways that you can define the use of a module and its types. These different patterns are managed by the <a href="https://github.com/paritytech/substrate/blob/master/srml/support/src/runtime.rs">macro definition</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="naming-your-module"></a><a href="#naming-your-module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Naming Your Module</h3>
<p>Each line in your <code>construct_runtime!</code> macro defines a module you are using in your runtime.</p>
<pre><code class="hljs css language-rust">System<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>default<span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>The lowercase <code>system</code> points to the Rust module where you have defined your runtime logic (following the standard Rust style guidelines). The uppercase <code>System</code> is a friendly name that you can define for your module which gets exposed through the runtime APIs.</p>
<h3><a class="anchor" aria-hidden="true" id="supported-types"></a><a href="#supported-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Supported Types</h3>
<p>The <code>construct_runtime!</code> macro provides support for the following types in a module:</p>
<ul>
<li><a href="#module"><code>Module</code></a></li>
<li><a href="#call"><code>Call</code></a></li>
<li><a href="#storage"><code>Storage</code></a></li>
<li><a href="#event"><code>Event</code></a> or <code>Event&lt;T&gt;</code> (if the event is <a href="https://doc.rust-lang.org/rust-by-example/generics.html">generic</a>)</li>
<li><a href="#origin"><code>Origin</code></a> or <code>Origin&lt;T&gt;</code> (if the origin is <a href="https://doc.rust-lang.org/rust-by-example/generics.html">generic</a>)</li>
<li><a href="#config"><code>Config</code></a> or <code>Config&lt;T&gt;</code> (if the config is <a href="https://doc.rust-lang.org/rust-by-example/generics.html">generic</a>)</li>
<li><a href="#log"><code>Log</code></a></li>
<li><a href="#inherent"><code>Inherent</code></a></li>
</ul>
<h3><a class="anchor" aria-hidden="true" id="no-types-or-default"></a><a href="#no-types-or-default" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>No Types or <code>default</code></h3>
<p>In the definition of the <code>Balances</code> or <code>Sudo</code> module, you see that we do not specify any of the types used within the module. In this case, the macro automatically expands this definition to include the following:</p>
<pre><code class="hljs css language-rust">Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span>
</code></pre>
<p>So these two lines are equivalent:</p>
<pre><code class="hljs css language-rust">Balances<span class="token punctuation">:</span> balances<span class="token punctuation">,</span>
<span class="token comment">// Same as...</span>
Balances<span class="token punctuation">:</span> balances<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<p>If you want to include these default types in addition to other types you define, you can use the <code>default</code> keyword as shown in the <code>System</code> module. Thus these two lines are equivalent as well:</p>
<pre><code class="hljs css language-rust">System<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>default<span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// Same as...</span>
System<span class="token punctuation">:</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token punctuation">{</span>Module<span class="token punctuation">,</span> Call<span class="token punctuation">,</span> Storage<span class="token punctuation">,</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> Config<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">,</span> <span class="token function">Log</span><span class="token punctuation">(</span>ChangesTrieRoot<span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="when-to-use-different-types"></a><a href="#when-to-use-different-types" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>When To Use Different Types</h2>
<p>As you can see, the types exposed by your various modules are what ultimately power the runtime. Most of these types are automatically generated by other macros used in the runtime development.</p>
<h3><a class="anchor" aria-hidden="true" id="module"></a><a href="#module" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Module</h3>
<p>The <code>Module</code> type is required by all modules in your runtime. This type gets generated through the <code>decl_module!</code> macro. This is where all the public functions your module exposes are defined. For example, in the <a href="https://github.com/paritytech/substrate/blob/master/srml/sudo/src/lib.rs"><code>Sudo</code></a> module which controls the management of &quot;admin&quot; access to your chain:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_module!</span> <span class="token punctuation">{</span>
    <span class="token comment">// Simple declaration of the `Module` type. Lets the macro know what its working on.</span>
    <span class="token keyword">pub</span> <span class="token keyword">struct</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">for</span> <span class="token keyword">enum</span> Call <span class="token keyword">where</span> origin<span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Origin <span class="token punctuation">{</span>
        <span class="token keyword">fn</span> deposit_event<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span> default<span class="token punctuation">;</span>

        <span class="token keyword">fn</span> <span class="token function">sudo</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> proposal<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Proposal<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// This is a public call, so we ensure that the origin is some signed account.</span>
            <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span>sender <span class="token operator">==</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"only the current sudo key can sudo"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">let</span> ok <span class="token operator">=</span> proposal<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>system<span class="token punctuation">:</span><span class="token punctuation">:</span>RawOrigin<span class="token punctuation">:</span><span class="token punctuation">:</span>Root<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">is_ok</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>RawEvent<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Sudid</span><span class="token punctuation">(</span>ok<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token keyword">fn</span> <span class="token function">set_key</span><span class="token punctuation">(</span>origin<span class="token punctuation">,</span> new<span class="token punctuation">:</span> <span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Lookup <span class="token keyword">as</span> StaticLookup<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Source<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// This is a public call, so we ensure that the origin is some signed account.</span>
            <span class="token keyword">let</span> sender <span class="token operator">=</span> <span class="token function">ensure_signed</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span>?<span class="token punctuation">;</span>
            <span class="token function">ensure!</span><span class="token punctuation">(</span>sender <span class="token operator">==</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"only the current sudo key can change the sudo key"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">let</span> new <span class="token operator">=</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Lookup<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">lookup</span><span class="token punctuation">(</span>new<span class="token punctuation">)</span>?<span class="token punctuation">;</span>

            <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_event</span><span class="token punctuation">(</span>RawEvent<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">KeyChanged</span><span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token operator">&lt;</span>Key<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">put</span><span class="token punctuation">(</span>new<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You can learn more about <code>decl_module!</code> <a href="/docs/zh-CN/runtime/macros/decl_module">here</a>.</p>
<h3><a class="anchor" aria-hidden="true" id="call"></a><a href="#call" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Call</h3>
<p>The <code>Call</code> type is an enum generated by the <code>decl_module!</code> macro which contains a list of all the callable functions and their arguments. For example, in the <a href="https://github.com/paritytech/substrate/blob/master/srml/sudo/src/lib.rs"><code>Sudo</code></a> module above, we should expect an enum similar to:</p>
<pre><code class="hljs css language-rust"><span class="token keyword">enum</span> Call<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token function">sudo</span><span class="token punctuation">(</span>proposal<span class="token punctuation">:</span> Box<span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Proposal<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">set_key</span><span class="token punctuation">(</span>new<span class="token punctuation">:</span> <span class="token operator">&lt;</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>Lookup <span class="token keyword">as</span> StaticLookup<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Source<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We will dig deeper into this topic [here] (Coming Soon).</p>
<h3><a class="anchor" aria-hidden="true" id="storage"></a><a href="#storage" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Storage</h3>
<p>The <code>Storage</code> type is exposed whenever your runtime uses the <code>decl_storage!</code> macro. This macro is used to save data used by your runtime module into the chain state.</p>
<p>We can look at the <a href="https://github.com/paritytech/substrate/blob/master/srml/sudo/src/lib.rs"><code>Sudo</code></a> module to see an example:</p>
<pre><code class="hljs css language-rust"><span class="token macro-rules function">decl_storage!</span> <span class="token punctuation">{</span>
    <span class="token keyword">trait</span> Store <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> <span class="token keyword">as</span> Sudo <span class="token punctuation">{</span>
        Key <span class="token function">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>You can learn more about <a href="https://github.com/paritytech/wiki/blob/master/decl_storage.md"><code>decl_storage!</code></a></p>
<h3><a class="anchor" aria-hidden="true" id="event"></a><a href="#event" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Event</h3>
<p>The <code>Event</code> type needs to be exposed whenever your module deposits events using the <code>decl_event!</code> module. Events can be used to easily report changes or conditions in your runtime to external entities like users, chain explorers, or dApps.</p>
<p>If you want to expose generic types defined by your module, you will need to make your type generic (Event<t>), as shown here:</p>
<pre><code class="hljs css language-rust"><span class="token comment">/// An event in this module.</span>
<span class="token function">decl_event!</span><span class="token punctuation">(</span>
    <span class="token keyword">pub</span> <span class="token keyword">enum</span> Event<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token keyword">where</span> AccountId <span class="token operator">=</span> <span class="token operator">&lt;</span>T <span class="token keyword">as</span> system<span class="token punctuation">:</span><span class="token punctuation">:</span>Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>AccountId <span class="token punctuation">{</span>
        <span class="token comment">/// A sudo just took place.</span>
        <span class="token function">Sudid</span><span class="token punctuation">(</span>bool<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token comment">/// The sudoer just switched identity; the old key is supplied.</span>
        <span class="token function">KeyChanged</span><span class="token punctuation">(</span>AccountId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Otherwise, you can simply use <code>Event</code> for non-generic types. You can learn more about <code>decl_event!</code> [here] (Coming Soon).</p>
<h3><a class="anchor" aria-hidden="true" id="origin"></a><a href="#origin" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Origin</h3>
<p>The <code>Origin</code> type is needed whenever your module declares a custom <code>Origin</code> enum to be used within your module.</p>
<p>Every function call to your runtime has an origin which specifies where the extrinsic was generated from. In the case of a signed extrinsic (transaction), the origin contains an identifier for the caller. The origin can be empty in the case of an inherent extrinsic.</p>
<p>You can see an example of a customized <code>Origin</code> in the <a href="https://github.com/paritytech/substrate/blob/master/srml/council/src/motions.rs">council motion module</a>:</p>
<pre><code class="hljs css language-rust"><span class="token comment">/// Origin for the council module.</span>
<span class="token attribute attr-name">#[derive(PartialEq, Eq, Clone)]</span>
<span class="token attribute attr-name">#[cfg_attr(feature = "std", derive(Debug))]</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> Origin <span class="token punctuation">{</span>
    <span class="token comment">/// It has been condoned by a given number of council members.</span>
    <span class="token function">Members</span><span class="token punctuation">(</span>u32<span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We will dig deeper into this topic [here] (Coming Soon).</p>
<h3><a class="anchor" aria-hidden="true" id="config"></a><a href="#config" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Config</h3>
<p>The <code>Config</code> type is needed whenever your module defines an initial state in the genesis configuration. By default, all storage variables are left in an 'unassigned' state, but using the <code>config()</code> keyword while declaring the storage variable allows you to initialize that state.</p>
<p>An example of that initialization can be found in the Substrate <code>node-template</code>, where Alice is set as the upgrade <code>Key</code> for <code>Sudo</code>. You can see from the <code>Storage</code> section that <code>Key</code> does have the <code>config()</code> parameter, and the value for it gets set in the <code>GenesisConfig</code> within <a href="https://github.com/paritytech/substrate/blob/master/node-template/src/chain_spec.rs">chain_spec.rs</a>:</p>
<pre><code class="hljs css language-rust">GenesisConfig <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
    sudo<span class="token punctuation">:</span> <span class="token function">Some</span><span class="token punctuation">(</span>SudoConfig <span class="token punctuation">{</span>
        key<span class="token punctuation">:</span> root_key<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We will dig deeper into this topic [here] (Coming Soon).</p>
<h3><a class="anchor" aria-hidden="true" id="log"></a><a href="#log" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Log</h3>
<p>The <code>Log</code> type is needed if your module generates logs entries for the runtime. Within the module, you must expose both a <code>Log</code> type and a <code>RawLog</code> enum which defines what the module is logging. Logs must satisfy the following requirements:</p>
<ol>
<li><p>The binary representation of all supported 'system' log items should stay the same. Otherwise, the native code will be unable to read log items generated by previous runtime versions.</p></li>
<li><p>The support of 'system' log items should never be dropped by runtime. Otherwise, native code will lose its ability to read items of this type even if they were generated by the versions which have supported these items.</p></li>
</ol>
<p>The <a href="https://github.com/paritytech/substrate/blob/master/srml/consensus/src/lib.rs"><code>Consensus</code> module</a> shows an example of how to implement a log:</p>
<pre><code class="hljs css language-rust"><span class="token keyword">pub</span> <span class="token keyword">type</span> Log<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token operator">=</span> RawLog<span class="token operator">&lt;</span>
    <span class="token operator">&lt;</span>T <span class="token keyword">as</span> Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>SessionKey<span class="token punctuation">,</span>
<span class="token operator">></span><span class="token punctuation">;</span>

<span class="token comment">/// Add logs in this module.</span>
<span class="token attribute attr-name">#[cfg_attr(feature = "std", derive(Serialize, Debug))]</span>
<span class="token attribute attr-name">#[derive(Encode, Decode, PartialEq, Eq, Clone)]</span>
<span class="token keyword">pub</span> <span class="token keyword">enum</span> RawLog<span class="token operator">&lt;</span>SessionKey<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment">/// Authorities set has been changed. Contains the new set of authorities.</span>
    <span class="token function">AuthoritiesChange</span><span class="token punctuation">(</span>Vec<span class="token operator">&lt;</span>SessionKey<span class="token operator">></span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token keyword">impl</span><span class="token operator">&lt;</span>SessionKey<span class="token punctuation">:</span> Member<span class="token operator">></span> RawLog<span class="token operator">&lt;</span>SessionKey<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment">/// Try to cast the log entry as AuthoritiesChange log entry.</span>
    <span class="token keyword">pub</span> <span class="token keyword">fn</span> <span class="token function">as_authorities_change</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">self</span><span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token punctuation">[</span>SessionKey<span class="token punctuation">]</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">match</span> <span class="token operator">*</span><span class="token keyword">self</span> <span class="token punctuation">{</span>
            RawLog<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">AuthoritiesChange</span><span class="token punctuation">(</span><span class="token keyword">ref</span> item<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">Some</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>It is customary to expose a <code>deposit_log()</code> function within your module which creates a log:</p>
<pre><code class="hljs css language-rust"><span class="token comment">/// Deposit one of this module's logs.</span>
<span class="token keyword">fn</span> <span class="token function">deposit_log</span><span class="token punctuation">(</span>log<span class="token punctuation">:</span> Log<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token operator">&lt;</span>system<span class="token punctuation">:</span><span class="token punctuation">:</span>Module<span class="token operator">&lt;</span>T<span class="token operator">>></span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">deposit_log</span><span class="token punctuation">(</span><span class="token operator">&lt;</span>T <span class="token keyword">as</span> Trait<span class="token operator">></span><span class="token punctuation">:</span><span class="token punctuation">:</span>Log<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">from</span><span class="token punctuation">(</span>log<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We will dig deeper into this topic [here] (Coming Soon).</p>
<h3><a class="anchor" aria-hidden="true" id="inherent"></a><a href="#inherent" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Inherent</h3>
<p>The <code>Inherent</code> type is needed when your module defines an implementation of the <code>ProvideInherent</code> trait.</p>
<p>This custom implementation is needed whenever your module wants to provide an inherent extrinsic and/or wants to verify an inherent extrinsic. If your module requires extra data for creating the inherent extrinsic, the data needs to be passed as <code>InherentData</code> into the runtime.</p>
<p>For example, in the <a href="https://github.com/paritytech/substrate/blob/master/srml/timestamp/src/lib.rs"><code>Timestamp</code> module</a>, an inherent data is used to set the timestamp for a given block by creating an extrinsic. As a peer authority of the block author, we confirm that the time proposed in the inherent extrinsic is within an acceptable period from our clock.</p>
<pre><code class="hljs css language-rust"><span class="token keyword">impl</span><span class="token operator">&lt;</span>T<span class="token punctuation">:</span> Trait<span class="token operator">></span> ProvideInherent <span class="token keyword">for</span> Module<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">type</span> Inherent <span class="token operator">=</span> T<span class="token punctuation">:</span><span class="token punctuation">:</span>Moment<span class="token punctuation">;</span>
    <span class="token keyword">type</span> Call <span class="token operator">=</span> Call<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">;</span>

    <span class="token keyword">fn</span> <span class="token function">create_inherent_extrinsics</span><span class="token punctuation">(</span>data<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>Inherent<span class="token punctuation">)</span> <span class="token punctuation">-></span> Vec<span class="token operator">&lt;</span><span class="token punctuation">(</span>u32<span class="token punctuation">,</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>Call<span class="token punctuation">)</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> next_time <span class="token operator">=</span> <span class="token punctuation">:</span><span class="token punctuation">:</span>rstd<span class="token punctuation">:</span><span class="token punctuation">:</span>cmp<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">max</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">block_period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">vec!</span><span class="token punctuation">[</span><span class="token punctuation">(</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>TIMESTAMP_SET_POSITION<span class="token punctuation">,</span> Call<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">set</span><span class="token punctuation">(</span>next_time<span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">fn</span> check_inherent<span class="token operator">&lt;</span>Block<span class="token punctuation">:</span> BlockT<span class="token punctuation">,</span> F<span class="token punctuation">:</span> <span class="token function">Fn</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Block<span class="token punctuation">:</span><span class="token punctuation">:</span>Extrinsic<span class="token punctuation">)</span> <span class="token punctuation">-></span> Option<span class="token operator">&lt;</span><span class="token operator">&amp;</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>Call<span class="token operator">>></span><span class="token punctuation">(</span>
            block<span class="token punctuation">:</span> <span class="token operator">&amp;</span>Block<span class="token punctuation">,</span> data<span class="token punctuation">:</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span>Inherent<span class="token punctuation">,</span> extract_function<span class="token punctuation">:</span> <span class="token operator">&amp;</span>F
    <span class="token punctuation">)</span> <span class="token punctuation">-></span> result<span class="token punctuation">:</span><span class="token punctuation">:</span>Result<span class="token operator">&lt;</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> CheckInherentError<span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> MAX_TIMESTAMP_DRIFT<span class="token punctuation">:</span> u64 <span class="token operator">=</span> <span class="token number">60</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> xt <span class="token operator">=</span> block<span class="token punctuation">.</span><span class="token function">extrinsics</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>T<span class="token punctuation">:</span><span class="token punctuation">:</span>TIMESTAMP_SET_POSITION <span class="token keyword">as</span> usize<span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">ok_or_else</span><span class="token punctuation">(</span><span class="token operator">||</span> CheckInherentError<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Other</span><span class="token punctuation">(</span><span class="token string">"No valid timestamp inherent in block"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>?<span class="token punctuation">;</span>

        <span class="token keyword">let</span> t <span class="token operator">=</span> <span class="token keyword">match</span> <span class="token punctuation">(</span>xt<span class="token punctuation">.</span><span class="token function">is_signed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">extract_function</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>xt<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token function">Some</span><span class="token punctuation">(</span><span class="token keyword">false</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">Some</span><span class="token punctuation">(</span>Call<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">ref</span> t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=></span> t<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            _ <span class="token operator">=></span> <span class="token keyword">return</span> <span class="token function">Err</span><span class="token punctuation">(</span>CheckInherentError<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Other</span><span class="token punctuation">(</span><span class="token string">"No valid timestamp inherent in block"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">let</span> minimum <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token keyword">Self</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">block_period</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">as_</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> t <span class="token operator">></span> data<span class="token punctuation">.</span><span class="token function">as_</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> MAX_TIMESTAMP_DRIFT <span class="token punctuation">{</span>
            <span class="token function">Err</span><span class="token punctuation">(</span>CheckInherentError<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">Other</span><span class="token punctuation">(</span><span class="token string">"Timestamp too far in future to accept"</span><span class="token punctuation">.</span><span class="token function">into</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> t <span class="token operator">&lt;</span> minimum <span class="token punctuation">{</span>
            <span class="token function">Err</span><span class="token punctuation">(</span>CheckInherentError<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">ValidAtTimestamp</span><span class="token punctuation">(</span>minimum<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token function">Ok</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>We will dig deeper into this topic [here] (Coming Soon).</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/docs/zh-CN/runtime/substrate-runtime-module-library"><span class="arrow-prev">← </span><span>Substrate Runtime 模块库</span></a><a class="docs-next button" href="/docs/zh-CN/runtime/macros/decl_module"><span>定义模块</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#defining-the-modules-used">Defining the Modules Used</a><ul class="toc-headings"><li><a href="#naming-your-module">Naming Your Module</a></li><li><a href="#supported-types">Supported Types</a></li><li><a href="#no-types-or-default">No Types or <code>default</code></a></li></ul></li><li><a href="#when-to-use-different-types">When To Use Different Types</a><ul class="toc-headings"><li><a href="#module">Module</a></li><li><a href="#call">Call</a></li><li><a href="#storage">Storage</a></li><li><a href="#event">Event</a></li><li><a href="#origin">Origin</a></li><li><a href="#config">Config</a></li><li><a href="#log">Log</a></li><li><a href="#inherent">Inherent</a></li></ul></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/Substrate-logo.svg" alt="Substrate Developer Hub" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/zh-CN/getting-started">Getting Started</a><a href="/zh-CN/tutorials">Tutorials</a><a href="/rustdocs/v1.0/">Reference Docs</a></div><div><h5>Community</h5><a href="/zh-CN/users.html">User Showcase</a><a href="http://stackoverflow.com/questions/tagged/substrate" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://riot.im/app/#/room/!HzySYSaIhtyWrwiwEV:matrix.org">Riot Chat</a><a href="https://twitter.com/ParityTech" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="https://www.parity.io/blog/">Blog</a><a href="https://github.com/paritytech/substrate">Substrate GitHub</a><a href="https://github.com/substrate-developer-hub/">Developer Hub GitHub</a><a class="github-button" href="https://github.com/substrate-developer-hub/substrate-developer-hub.github.io" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><section class="copyright">Copyright © 2019 Parity Technologies</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '5cd09916f4ba4c283b2d45ee7386fc34',
                indexName: 'substrate',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["language:zh-CN"]}
              });
            </script></body></html>